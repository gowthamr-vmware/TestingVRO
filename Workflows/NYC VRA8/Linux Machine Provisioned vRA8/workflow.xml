<workflow xmlns="http://vmware.com/vco/workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://vmware.com/vco/workflow http://vmware.com/vco/workflow/Workflow-v4.xsd" root-name="item1" object-name="workflow:name=generic" id="30dd5cc8-453d-4be4-8879-b62f33c04a13" version="1.0.0" api-version="6.0.0" allowed-operations="vef" editor-version="2.0" restartMode="1" resumeFromFailedMode="0"><display-name><![CDATA[Linux Machine Provisioned vRA8]]></display-name><description><![CDATA[This work flow acts as a master workflow for all the tasks that are to be provisioned after the VM provisioning.]]></description><position y="50.0" x="60.0"/><input><param name="scriptVariables" type="Array/CompositeType(stringToReplace:string,replacingString:string):scriptVariables"/><param name="inputProperties" type="Properties"/></input><output><param name="scriptExitCodeOut" type="number"/><param name="scriptOutputTextOut" type="string"/><param name="scriptExitCodeOut2" type="number"/><param name="scriptOutputTextOut2" type="string"/><param name="scriptExitCodeOut1" type="number"/><param name="scriptOutputTextOut1" type="string"/><param name="scriptExitCodeOut4" type="number"/><param name="scriptOutputTextOut4" type="string"/><param name="scriptExitCodeOut3" type="number"/><param name="scriptOutputTextOut3" type="string"/></output><attrib name="vmUsername" type="string" read-only="false"><value encoded="n"><![CDATA[vrautomation]]></value></attrib><attrib name="vmPassword" type="SecureString" read-only="false"><value encoded="n"><![CDATA[16BI33N50N56O40G71N67K42O24K75R51H21M67U52J47Q67L6BZC8001C0K101CC80RDBCAB09VE0C1FDI411368VB252F87M4155B0DZ895D563IB038BE7I5E74B4BU47D19E0ZC9812DEW40EDFD8W49CD7E7G6823086G95167B4M]]></value></attrib><attrib name="scriptConfigurationResource" type="ResourceElement" read-only="false"><value encoded="n"><![CDATA[dunes://service.dunes.ch/ResourceElement?id='8e2a7c7d-87cc-4ff9-b998-8ddc686f8406'&dunesName='ResourceElement']]></value></attrib><attrib name="pollingRate" type="number" read-only="false"><value encoded="n"><![CDATA[10.0]]></value><description><![CDATA[Time between all request information on the tools [seconds]]]></description></attrib><attrib name="timeout" type="number" read-only="false"><value encoded="n"><![CDATA[10.0]]></value><description><![CDATA[Timeout before throwing a timeout exception [minutes]]]></description></attrib><attrib name="scriptConfigurationResource2" type="ResourceElement" read-only="false"><value encoded="n"><![CDATA[dunes://service.dunes.ch/ResourceElement?id='69eb5d7d-6fdc-41a1-ad36-fd0743c0883b'&dunesName='ResourceElement']]></value></attrib><attrib name="scriptConfigurationResource4" type="ResourceElement" read-only="false"><value encoded="n"><![CDATA[dunes://service.dunes.ch/ResourceElement?id='79a66afe-3cc2-4244-876c-3fd8ab361c7f'&dunesName='ResourceElement']]></value></attrib><attrib name="sleepTime" type="number" read-only="false"><value encoded="n"><![CDATA[120.0]]></value><description><![CDATA[Time to sleep in seconds]]></description></attrib><attrib name="scriptExitCodeOut5" type="number" read-only="false"><value encoded="n"/></attrib><attrib name="scriptOutputTextOut5" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="sleepTimeforSymantec" type="number" read-only="false"><value encoded="n"><![CDATA[150.0]]></value><description><![CDATA[Time to sleep in seconds]]></description></attrib><attrib name="scriptConfigurationResource3" type="ResourceElement" read-only="false"><value encoded="n"><![CDATA[dunes://service.dunes.ch/ResourceElement?id='60f9ced5-6021-4e22-b5a0-f98d1b077f11'&dunesName='ResourceElement']]></value></attrib><attrib name="errorCode" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="vCenterVm" type="VC:VirtualMachine" read-only="false"><value encoded="n"/></attrib><attrib name="Role" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="machineDescription" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="machineDomain" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="roleKey" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="customProperties" type="Properties" read-only="false"><value encoded="n"><![CDATA[{}]]></value></attrib><workflow-item name="item0" type="end" end-mode="0"><in-binding/><position y="50.0" x="840.0"/></workflow-item><workflow-item name="item1" out-name="item24" type="task"><display-name><![CDATA[Read inputproperties]]></display-name><script encoded="false"><![CDATA[System.log("Machine Provisioned started.");
System.log("inputProperties: " + JSON.stringify(inputProperties));
var vmName = inputProperties.get('resourceNames')[0];
vCenterVm = VcPlugin.getAllVirtualMachines(null, "xpath:matches(name, '" + vmName + "')")[0];    
customProperties = inputProperties.get('customProperties');
roleKey = customProperties.get('custom.role');
machineDomain = customProperties.get('custom.machineDomain');]]></script><in-binding><bind name="inputProperties" type="Properties" export-name="inputProperties"/></in-binding><out-binding><bind name="vCenterVm" type="VC:VirtualMachine" export-name="vCenterVm"/><bind name="machineDescription" type="string" export-name="machineDescription"/><bind name="machineDomain" type="string" export-name="machineDomain"/><bind name="roleKey" type="string" export-name="roleKey"/><bind name="customProperties" type="Properties" export-name="customProperties"/></out-binding><position y="60.0" x="140.0"/></workflow-item><workflow-item name="item3" out-name="item25" type="task" script-module="com.vmware.library.vc.vm.tools/vim3WaitToolsStarted"><display-name><![CDATA[vim3WaitToolsStarted]]></display-name><script encoded="false"><![CDATA[//Auto generated script, cannot be modified !
System.getModule("com.vmware.library.vc.vm.tools").vim3WaitToolsStarted(vm,pollingRate,timeout) ;]]></script><in-binding><bind name="pollingRate" type="number" export-name="pollingRate"><description><![CDATA[Time between all request information on the tools [seconds]]]></description></bind><bind name="timeout" type="number" export-name="timeout"><description><![CDATA[Timeout before throwing a timeout exception [minutes]]]></description></bind><bind name="vm" type="VC:VirtualMachine" export-name="vCenterVm"><description><![CDATA[VM in which the action look to get the new DNS Name]]></description></bind></in-binding><out-binding/><description><![CDATA[Wait for the VMware tools to be up and the guest running

Exception:
- Timeout: When timeout is reached
- ReferenceError: When vm is not set correctly]]></description><position y="60.0" x="420.0"/></workflow-item><workflow-item name="item24" out-name="item3" type="task"><display-name><![CDATA[Get role description]]></display-name><script encoded="false"><![CDATA[var __global = System.getContext() || (function () {
    return this;
}).call(null);
var VROES = __global.__VROES || (__global.__VROES = System.getModule("com.vmware.pscoe.library.ecmascript").VROES());
var utils_1 = VROES.importLazy("com.vmware.pscoe.nyc.vra_integration.vro.actions/utils/utils");
var config = utils_1._.Utils.getConfig('NYC/CustomHostname');
var rolesProperties = config.get('roles');
Role = rolesProperties.get(roleKey);]]></script><in-binding><bind name="roleKey" type="string" export-name="roleKey"/></in-binding><out-binding><bind name="Role" type="string" export-name="Role"/></out-binding><description><![CDATA[Simple task with custom script capability.]]></description><position y="60.0" x="280.0"/></workflow-item><workflow-item name="item25" out-name="item0" type="link" linked-workflow-id="b8a9918a-177e-499d-b499-5ad0c7d6e414"><display-name><![CDATA[Install Crowdstrike]]></display-name><in-binding><bind name="vm" type="VC:VirtualMachine" export-name="vCenterVm"/><bind name="vmUsername" type="string" export-name="vmUsername"/><bind name="vmPassword" type="SecureString" export-name="vmPassword"/></in-binding><out-binding><bind name="scriptExitCodeOut" type="number" export-name="scriptExitCodeOut"/><bind name="scriptOutputTextOut" type="string" export-name="scriptOutputTextOut"/></out-binding><description><![CDATA[]]></description><position y="60.0" x="580.0"/></workflow-item><presentation><p-param name="scriptVariables"><desc><![CDATA[scriptVariables]]></desc></p-param></presentation></workflow>