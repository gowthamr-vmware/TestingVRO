<workflow xmlns="http://vmware.com/vco/workflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://vmware.com/vco/workflow http://vmware.com/vco/workflow/Workflow-v4.xsd" root-name="item26" object-name="workflow:name=generic" id="d5476b68-cdbd-450b-8e16-425ff0dce4a0" version="1.0.0" api-version="6.0.0" allowed-operations="vef" editor-version="2.0" restartMode="1" resumeFromFailedMode="0"><display-name><![CDATA[Do Onboarding No Tags]]></display-name><position y="50.0" x="40.0"/><input><param name="inputVMs" type="string"/><param name="planName" type="string"/><param name="dryRun" type="boolean"/></input><attrib name="vmNames" type="Array/string" read-only="false"><value encoded="n"><![CDATA[[]]]></value></attrib><attrib name="vraURL" type="string" read-only="false"><value encoded="n"><![CDATA[https://api.mgmt.cloud.vmware.com/]]></value></attrib><attrib name="machineIDs" type="Array/string" read-only="false"><value encoded="n"><![CDATA[[]]]></value></attrib><attrib name="backupCategoryID" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="vraFoundSessionToken" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="projectID" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="endpointID" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="createdPlanID" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="bearerToken" type="string" read-only="false"><value encoded="n"/></attrib><attrib name="configurationElement" type="ConfigurationElement" read-only="false"><value encoded="n"/><description><![CDATA[needs: projectID, endpointID]]></description></attrib><workflow-item name="item1" out-name="item2" type="task"><display-name><![CDATA[Split Names And Setup]]></display-name><script encoded="false"><![CDATA[vmNames = inputVMs.split(',');

projectID = configurationElement.getAttributeWithKey('projectID').value;
System.log('projectID ' + projectID);
endpointID = configurationElement.getAttributeWithKey('endpointID').value;
System.log('endpointID ' + endpointID);]]></script><in-binding><bind name="inputVMs" type="string" export-name="inputVMs"/><bind name="configurationElement" type="ConfigurationElement" export-name="configurationElement"/></in-binding><out-binding><bind name="vmNames" type="Array/string" export-name="vmNames"/><bind name="projectID" type="string" export-name="projectID"/><bind name="endpointID" type="string" export-name="endpointID"/></out-binding><description><![CDATA[Simple task with custom script capability.]]></description><position y="60.0" x="220.0"/></workflow-item><workflow-item name="item2" out-name="item17" type="link" linked-workflow-id="6f43f41b-cd27-4f4e-9a16-7be47f1b4675"><display-name><![CDATA[Get VRA Machines]]></display-name><in-binding><bind name="inputSessionToken" type="string" export-name="bearerToken"/><bind name="vraURL" type="string" export-name="vraURL"/><bind name="username" type="string"/><bind name="password" type="SecureString"/><bind name="machineNames" type="Array/string" export-name="vmNames"/></in-binding><out-binding><bind name="foundMachines" type="Array/string" export-name="machineIDs"/></out-binding><description><![CDATA[]]></description><position y="60.0" x="360.0"/></workflow-item><workflow-item name="item10" out-name="item24" type="link" linked-workflow-id="0dd9d553-0f21-4c3d-8409-3f613c46a02e"><display-name><![CDATA[Run Plan And Monitor]]></display-name><in-binding><bind name="vraURL" type="string" export-name="vraURL"/><bind name="username" type="string" export-name=""/><bind name="password" type="SecureString" export-name=""/><bind name="inputSessionToken" type="string" export-name="vraFoundSessionToken"/><bind name="planID" type="string" export-name="createdPlanID"/></in-binding><out-binding/><description><![CDATA[]]></description><position y="240.0" x="180.0"/></workflow-item><workflow-item name="item17" out-name="item23" type="task"><display-name><![CDATA[Log Machines]]></display-name><script encoded="false"><![CDATA[System.log('FOUND IDS' + machineIDs);]]></script><in-binding><bind name="machineIDs" type="Array/string" export-name="machineIDs"/></in-binding><out-binding/><description><![CDATA[Simple task with custom script capability.]]></description><position y="120.0" x="360.0"/></workflow-item><workflow-item name="item18" out-name="item28" type="task"><display-name><![CDATA[Logging]]></display-name><script encoded="false"><![CDATA[System.log('run plan and monitor')

if (vraFoundSessionToken && vraFoundSessionToken.trim() != '') {
    System.log('session present')
} else { System.log('no session')}]]></script><in-binding><bind name="vraFoundSessionToken" type="string" export-name="vraFoundSessionToken"/></in-binding><out-binding/><description><![CDATA[Simple task with custom script capability.]]></description><position y="180.0" x="20.0"/></workflow-item><workflow-item name="item23" out-name="item25" type="link" linked-workflow-id="56194641-4055-4bf6-91de-fa1dd205d34b"><display-name><![CDATA[Create Plan]]></display-name><in-binding><bind name="inputSessionToken" type="string" export-name="bearerToken"/><bind name="vraURL" type="string" export-name="vraURL"/><bind name="username" type="string"/><bind name="password" type="SecureString"/><bind name="projectID" type="string" export-name="projectID"/><bind name="endpointID" type="string" export-name="endpointID"/><bind name="planName" type="string" export-name="planName"/></in-binding><out-binding><bind name="planID" type="string" export-name="createdPlanID"/><bind name="outputSessionToken" type="string" export-name="vraFoundSessionToken"/></out-binding><description><![CDATA[]]></description><position y="120.0" x="200.0"/></workflow-item><workflow-item name="item24" type="end" end-mode="0"><in-binding/><position y="230.0" x="380.0"/></workflow-item><workflow-item name="item25" out-name="item18" type="link" linked-workflow-id="b295f005-dc7e-4665-ab70-5ee03ae3b842"><display-name><![CDATA[Add Machines To Plan]]></display-name><in-binding><bind name="inputSessionToken" type="string" export-name="vraFoundSessionToken"/><bind name="vraURL" type="string" export-name="vraURL"/><bind name="username" type="string" export-name=""/><bind name="password" type="SecureString" export-name=""/><bind name="planID" type="string" export-name="createdPlanID"/><bind name="machineIDs" type="Array/string" export-name="machineIDs"/><bind name="vmNames" type="Array/string" export-name="vmNames"/></in-binding><out-binding/><description><![CDATA[]]></description><position y="120.0" x="20.0"/></workflow-item><workflow-item name="item26" out-name="item1" type="link" linked-workflow-id="681d977d-9a67-42a8-a7ce-b97cada93971"><display-name><![CDATA[Get vRA Cloud Bearer Token]]></display-name><in-binding/><out-binding><bind name="token2" type="string" export-name="bearerToken"/></out-binding><description><![CDATA[]]></description><position y="60.0" x="100.0"/></workflow-item><workflow-item name="item28" out-name="item29" type="condition" alt-out-name="item10" comparator="0"><display-name><![CDATA[Decision]]></display-name><script encoded="false"><![CDATA[// Generated by the system, cannot be edited
return (dryRun === true);]]></script><in-binding><bind name="dryRun" type="boolean" export-name="dryRun"/></in-binding><out-binding/><condition name="dryRun" type="boolean" comparator="0" label="null"/><description><![CDATA[Custom decision based on a custom script.]]></description><position y="230.0" x="20.0"/></workflow-item><workflow-item name="item29" type="end" end-mode="0"><in-binding/><position y="290.0" x="60.0"/></workflow-item><presentation/></workflow>